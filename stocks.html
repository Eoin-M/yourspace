<html ng-app="stocks">
<head>
	<style>
		.mainStockDiv
		{
			display: inline-block;
		}
		.individualStock
		{
			outline: #D1E0E0 solid;
			padding: 5px;
		}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
	<script>
	var stocks = angular.module('stocks', []);
	window.onload = function()
	{
		$('getMulStockBtn').trigger();
	}
	stocks.controller('mainController', function ($scope, $http)
	{
		$scope.getStock=function()
		{
			console.log("entered getStock");
			$http.post('/stocks', JSON.stringify({target: $scope.wantedStock}))
			.success(function(data){
			console.dir(data);
			if (data.lastTradePriceOnly !== null)
			{
				data.symbol = data.symbol.toUpperCase();
				$scope.multiStocks.push(data);
			}
			else 
			{
				$scope.stockName = "Not found";
				$scope.stockPrice = "";
				$scope.stockChange = "";
			}
			//alert(data.stock.symbol)
			}).error(function(data){
			alert("failed");
			});
		};
		$scope.getMultStock=function()
		{
			console.log("entered getMultStock");
			$http.post('/multStocks')
			.success(function(data){
			//console.dir(data);
			$scope.multiStocks = data
			}).error(function(data){
			alert("failed");
			});
		};
			
	});
	</script>
</head>
<body ng-controller="mainController" >
	<div ng-init="getMultStock()" class="mainStockDiv"><!-- calls getMultStock() on load-->

		<div ng-repeat="multiStock in multiStocks" class="individualStock">
			<div>Stock: {{ multiStock.symbol }}</div>
			<div>Price: {{ multiStock.lastTradePriceOnly }}</div>
			<div>Change: {{ multiStock.change }}</div>
		</div>
		<input type="text" ng-model="wantedStock" placeholder="Add another stock" >
		<button ng-click="getStock()">Click</button>
	</div>
</body>
</html>